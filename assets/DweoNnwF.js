import{_ as A}from"./uGsgA5E7.js";import{J as C,_ as z,r as c,k as y,o as E,x as m,z as t,D as _,B as L,Q as D,R as N,S as x,O,P as I,A as u,T as P,U as g,y as b}from"./DXbd3OtC.js";import{A as h}from"./C-JkpvZu.js";const j=C("/image/f-orange.png"),F=C("/image/f-pink.png"),J={class:"header"},q=["disabled"],U=["disabled"],R={id:"todo-list"},Q=["onClick"],Y=["onClick","disabled"],G={id:"progress-bar-container"},K={id:"progress-label"},W={id:"progress-bar"},v="todo",X={__name:"index",setup(Z){const r=c(""),a=c([]),i=c(!1),f=c(!1),w=y(()=>a.value.filter(o=>o.checked===!0||o.checked==="true").length),d=y(()=>a.value.length===0?0:Math.round(w.value/a.value.length*100));function B(o){return o.checked===!0||o.checked==="true"}function k(){i.value=!0,fetch(`${h}?table=${v}`).then(o=>o.json()).then(o=>{a.value=o}).catch(()=>alert("載入失敗")).finally(()=>i.value=!1)}function S(){if(!r.value)return;const o={id:Date.now(),content:r.value,checked:!1};a.value.push(o),r.value="",fetch(`${h}?table=${v}&action=add`,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(o),redirect:"follow"}).then(e=>e.json()).then(e=>{if(e.status==="success")console.log("新增成功");else throw new Error}).catch(()=>{ElMessage.error("新增失敗"),k()})}function H(o){const e=a.value[o],n=e.checked;e.checked=!n,d.value===100&&$();let s={id:e.id,checked:e.checked};fetch(`${h}?table=${v}&action=update`,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(s),redirect:"follow"}).then(l=>l.json()).then(l=>{if(l.status!=="success")throw new Error}).catch(()=>{e.checked=n,alert("更新失敗")})}function T(o){if(!confirm("確定刪除？"))return;const e=a.value.findIndex(s=>s.id===o),n=a.value[e];a.value.splice(e,1),fetch(`${h}?table=${v}&action=delete`,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({id:o}),redirect:"follow"}).then(s=>s.json()).then(s=>{if(s.status!=="success")throw new Error}).catch(()=>{a.value.splice(e,0,n),alert("刪除失敗")})}function $(){f.value=!1,requestAnimationFrame(()=>{f.value=!0})}function M(){const o=document.getElementById("todo-list"),e=document.getElementById("progress-bar-container"),n=document.getElementById("todo-form"),l=document.querySelector("h1").offsetHeight+n.offsetHeight+32,p=e.offsetHeight+46,V=window.innerHeight-l-p;o.style.maxHeight=V+"px",o.style.overflowY="auto"}return E(()=>{k(),M()}),(o,e)=>{const n=A;return b(),m("div",{class:g(["container",{"pink-mode":d.value===100}])},[t("div",J,[t("button",{class:"back-btn",onClick:e[0]||(e[0]=s=>o.$router.push("/"))},e[2]||(e[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-compact-left",viewBox:"0 0 16 16"},[t("path",{"fill-rule":"evenodd",d:"M9.224 1.553a.5.5 0 0 1 .223.67L6.56 8l2.888 5.776a.5.5 0 1 1-.894.448l-3-6a.5.5 0 0 1 0-.448l3-6a.5.5 0 0 1 .67-.223"})],-1),_(" 返回 ")])),e[3]||(e[3]=t("h1",null,"待辦清單",-1)),e[4]||(e[4]=t("img",{src:j,class:"deco-items",id:"orange-flower"},null,-1)),e[5]||(e[5]=t("img",{src:F,class:"deco-items",id:"pink-flower"},null,-1))]),t("form",{id:"todo-form",autocomplete:"off",onSubmit:x(S,["prevent"])},[D(t("input",{type:"text",id:"new-todo",placeholder:"新增待辦...","onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),disabled:i.value},null,8,q),[[N,r.value,void 0,{trim:!0}]]),t("button",{class:"add-btn",type:"submit",disabled:i.value},"新增",8,U)],32),t("ul",R,[(b(!0),m(O,null,I(a.value,(s,l)=>(b(),m("li",{key:s.id,class:g({checked:B(s)}),onClick:p=>H(l)},[t("span",null,u(s.content),1),t("button",{class:"del-btn",onClick:x(p=>T(s.id),["stop"]),disabled:i.value},e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[t("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),t("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1)]),8,Y)],10,Q))),128))]),t("div",G,[t("div",K," 已完成 "+u(w.value)+" / "+u(a.value.length)+"（"+u(d.value)+"%） ",1),t("div",W,[t("div",{id:"progress-bar-fill",style:P({width:d.value+"%",backgroundColor:d.value===100?"#f39083":"#69491A"})},null,4)])]),e[8]||(e[8]=_(" <")),L(n,{visible:i.value,color:"#69491a"},null,8,["visible"]),t("div",{id:"heart-burst",class:g({animate:f.value})},e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"heart-icon",viewBox:"0 0 16 16",fill:"#FF69B4"},[t("path",{d:"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"})],-1)]),2)],2)}}},ae=z(X,[["__scopeId","data-v-b3921a28"]]);export{ae as default};
