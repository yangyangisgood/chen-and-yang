import{_ as E,r as p,o as R,x as b,z as t,L as A,V as F,U as D,B as o,D as r,O as V,P as S,C as n,S as I,R as J,T as f,g as d,y as c,A as x,N as P,W as K}from"./M10hBGB8.js";const Q={class:"container"},W=["disabled"],G={class:"wood-background"},H={class:"sushi-grid"},Z=["onClick"],q=["src"],X={key:0},ee={style:{"margin-top":"1em","text-align":"center"}},le={style:{"text-align":"right"}},te={id:"loader"},k="https://script.google.com/macros/s/AKfycbxCpBro8KBNZ_ObB8RaURjjC8oRmJ0DT08rcCzHiQelAe1Onrztax9fwLzUdb6QjWf8/exec",oe={__name:"index",setup(ae){const y=p([]),g=p(!1),v=p(!1),i=p(!1),u=p(null),s=p({user:"",date:"",sushiType:"",content:""}),C=[{label:"小黃瓜捲",file:"cucumber.png",emoji:"🥒"},{label:"玉子燒壽司",file:"tamago.png",emoji:"🍳"},{label:"蝦壽司",file:"shrimp.png",emoji:"🍤"},{label:"干貝壽司",file:"scallop.png",emoji:"🦪"},{label:"鰻魚壽司",file:"eel.png",emoji:"⚡🐟"},{label:"鮪魚壽司",file:"tuna.png",emoji:"🐠"},{label:"鮭魚壽司",file:"salmon.png",emoji:"🍣"},{label:"鮭魚壽司加芥末",file:"salmon-wasabi.png",emoji:"🌶️🍣"}];function j(){s.value={user:"",date:"",sushiType:"",content:""}}function U(a){const e=C.find(m=>m.label===a);return e?`/chen-and-yang/image/${e.file}`:""}function h(){i.value=!0,j(),fetch(`${k}?action=list`).then(a=>a.json()).then(a=>y.value=a.reverse()).catch(()=>f.error("載入失敗")).finally(()=>i.value=!1)}function M(a){u.value=a,g.value=!0}function N(){if(y.value.length>=8){f.error("最多八顆壽司！請先吃掉一些！");return}v.value=!0}function O(){const a={...s.value,id:Date.now()};i.value=!0,fetch(k,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(a),redirect:"follow"}).then(e=>e.json()).then(e=>{if(e.success)f.success("新增成功！"),v.value=!1,h();else throw new Error}).catch(()=>f.error("新增失敗")).finally(()=>i.value=!1)}function Y(){u.value&&K.confirm("請先與伴侶討論，確定要吃掉壽司嗎？","！！！！！",{confirmButtonText:"是的，可以吃掉了",cancelButtonText:"再想一下"}).then(()=>{i.value=!0,fetch(k,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:"delete",id:u.value.id}),redirect:"follow"}).then(a=>a.json()).then(a=>{if(a.success)f.success("壽司已成功吃掉（消化中）🍣💨"),g.value=!1,h();else throw new Error}).catch(()=>f.error("刪除失敗，壽司還沒咽下去...")).finally(()=>{i.value=!1})}).catch(()=>{})}return R(h),(a,e)=>{const m=d("el-button"),T=d("el-dialog"),w=d("el-option"),B=d("el-select"),_=d("el-form-item"),L=d("el-date-picker"),$=d("el-input"),z=d("el-form");return c(),b(V,null,[t("div",Q,[t("button",{class:"back-btn",onClick:e[0]||(e[0]=l=>a.$router.push("/"))},e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-compact-left",viewBox:"0 0 16 16"},[t("path",{"fill-rule":"evenodd",d:"M9.224 1.553a.5.5 0 0 1 .223.67L6.56 8l2.888 5.776a.5.5 0 1 1-.894.448l-3-6a.5.5 0 0 1 0-.448l3-6a.5.5 0 0 1 .67-.223"})],-1),r(" 返回 ")])),e[16]||(e[16]=t("h1",null,"不迴轉壽司",-1)),t("button",{class:"add-btn",onClick:N,disabled:i.value}," 捏一顆壽司 ",8,W),t("div",G,[t("div",H,[(c(!0),b(V,null,S(y.value,l=>(c(),b("div",{class:"sushi-item",key:l.id,onClick:ne=>M(l)},[t("img",{class:"sushi-img",src:U(l.sushiType),alt:"壽司"},null,8,q)],8,Z))),128))])]),u.value?(c(),F(T,{key:0,modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=l=>g.value=l),title:"詳細內容",width:"90%",class:I(u.value.sushiType==="鮭魚壽司加芥末"?"wasabi":"")},{default:n(()=>[u.value?(c(),b("div",X,[t("p",null,[e[9]||(e[9]=t("strong",null,"🗓 日期：",-1)),r(x(u.value.date),1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"🧑 壽司師傅：",-1)),r(x(u.value.user),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"📓 內容：",-1)),r(x(u.value.content),1)]),t("div",ee,[o(m,{type:"danger",onClick:Y},{default:n(()=>e[12]||(e[12]=[r("吃掉壽司")])),_:1,__:[12]})])])):D("",!0)]),_:1},8,["modelValue","class"])):D("",!0),o(T,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=l=>v.value=l),title:"捏捏捏捏捏壽司",width:"90%"},{default:n(()=>[o(z,{onSubmit:P(O,["prevent"]),"label-width":"80px"},{default:n(()=>[o(_,{label:"壽司師傅"},{default:n(()=>[o(B,{modelValue:s.value.user,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.user=l),placeholder:"你是誰"},{default:n(()=>[o(w,{label:"洋",value:"洋"}),o(w,{label:"陳",value:"陳"})]),_:1},8,["modelValue"])]),_:1}),o(_,{label:"日期"},{default:n(()=>[o(L,{modelValue:s.value.date,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.date=l),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:"請選擇日期"},null,8,["modelValue"])]),_:1}),o(_,{label:"項目"},{default:n(()=>[o($,{modelValue:s.value.content,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.content=l),type:"textarea",placeholder:"請輸入不爽的小事"},null,8,["modelValue"])]),_:1}),o(_,{label:"壽司口味"},{default:n(()=>[o(B,{modelValue:s.value.sushiType,"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.sushiType=l),placeholder:"選擇一種壽司"},{default:n(()=>[(c(),b(V,null,S(C,l=>o(w,{key:l.label,label:l.label+l.emoji,value:l.label},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t("div",le,[o(m,{onClick:j},{default:n(()=>e[13]||(e[13]=[r("清空")])),_:1,__:[13]}),o(m,{onClick:e[6]||(e[6]=l=>v.value=!1)},{default:n(()=>e[14]||(e[14]=[r("取消")])),_:1,__:[14]}),o(m,{type:"primary","native-type":"submit",loading:i.value},{default:n(()=>e[15]||(e[15]=[r("送出")])),_:1,__:[15]},8,["loading"])])]),_:1})]),_:1},8,["modelValue"])]),A(t("div",te,e[17]||(e[17]=[t("span",{class:"loader-icon"},null,-1),t("span",{style:{"margin-left":"8px",color:"#252c74"}},"載入中...",-1)]),512),[[J,i.value]])],64)}}},ie=E(oe,[["__scopeId","data-v-5dc30e7e"]]);export{ie as default};
