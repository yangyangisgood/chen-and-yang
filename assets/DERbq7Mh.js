import{_ as E,r,o as O,x as b,z as l,L as R,B as o,D as m,C as n,R as $,O as U,T as c,g as u,y as _,P as z,V as A,A as y,U as I,N as P}from"./B8gU_bnY.js";const j={class:"container"},J=["disabled"],K={key:0,class:"dialog-content"},X={style:{"text-align":"right","margin-top":"10px"}},q={id:"loader"},Y="https://script.google.com/macros/s/AKfycbzdXRVWPMFpBymxg7xB1b6N6--XYxJQ6KmlogLsboDU0y1Etb6RyvF8V32rw5IzUUsqYg/exec",G={__name:"index",setup(Q){const V=r([]),g=r(!1),p=r(!1),d=r(null),i=r(!1),a=r({type:"",date:"",title:"",content:""});function M(s){const e=new Date(s);return isNaN(e)?s:new Date(e.getTime()+8*60*60*1e3).toISOString().split("T")[0]}function w(){i.value=!0,fetch(Y).then(s=>s.json()).then(s=>{V.value=s.filter(e=>e.date).map(e=>({...e,date:M(e.date)})).sort((e,v)=>new Date(v.date)-new Date(e.date))}).catch(()=>c.error("載入失敗")).finally(()=>i.value=!1)}function N(s){d.value=s,g.value=!0}function B(){p.value=!0,a.value={type:"",date:"",title:"",content:""}}function S(){if(!a.value.type||!a.value.date||!a.value.content){c.warning("請填寫所有欄位");return}i.value=!0;const s={...a.value,date:a.value.date,id:Date.now()};fetch(Y,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(s),redirect:"follow"}).then(e=>e.json()).then(e=>{if(e.success)c.success("新增成功"),p.value=!1,w();else throw new Error}).catch(()=>c.error("新增失敗")).finally(()=>i.value=!1)}return O(w),(s,e)=>{const v=u("el-timeline-item"),T=u("el-timeline"),x=u("el-dialog"),D=u("el-radio"),L=u("el-radio-group"),f=u("el-form-item"),F=u("el-date-picker"),k=u("el-input"),C=u("el-button"),h=u("el-form");return _(),b(U,null,[l("div",j,[l("button",{class:"back-btn",onClick:e[0]||(e[0]=t=>s.$router.push("/"))},e[8]||(e[8]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-compact-left",viewBox:"0 0 16 16"},[l("path",{"fill-rule":"evenodd",d:"M9.224 1.553a.5.5 0 0 1 .223.67L6.56 8l2.888 5.776a.5.5 0 1 1-.894.448l-3-6a.5.5 0 0 1 0-.448l3-6a.5.5 0 0 1 .67-.223"})],-1),m(" 返回 ")])),e[15]||(e[15]=l("h1",null,"約會日記",-1)),l("button",{class:"add-btn",onClick:B,disabled:i.value},"新增",8,J),o(T,{class:"timeline-box"},{default:n(()=>[(_(!0),b(U,null,z(V.value,t=>(_(),A(v,{key:t.id,timestamp:t.date,color:t.type==="紀念日"?"#86b1a3":"#ccc",onClick:W=>N(t),class:"timeline-item"},{default:n(()=>[m(y(t.title),1)]),_:2},1032,["timestamp","color","onClick"]))),128))]),_:1}),o(x,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=t=>g.value=t),title:d.value?d.value.title:"no data",width:"90%"},{default:n(()=>[d.value?(_(),b("div",K,[l("p",null,[e[9]||(e[9]=l("strong",null,"日期：",-1)),l("span",null,y(d.value.date),1)]),l("p",null,[e[10]||(e[10]=l("strong",null,"內容：",-1)),l("span",null,y(d.value.content),1)])])):I("",!0)]),_:1},8,["modelValue","title"]),o(x,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=t=>p.value=t),title:"新增紀錄",width:"90%"},{default:n(()=>[o(h,{onSubmit:P(S,["prevent"]),"label-width":"80px"},{default:n(()=>[o(f,{label:"種類"},{default:n(()=>[o(L,{modelValue:a.value.type,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.type=t)},{default:n(()=>[o(D,{value:"紀念日"},{default:n(()=>e[11]||(e[11]=[m("紀念日")])),_:1,__:[11]}),o(D,{value:"約會"},{default:n(()=>e[12]||(e[12]=[m("約會")])),_:1,__:[12]})]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"日期"},{default:n(()=>[o(F,{modelValue:a.value.date,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.date=t),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:"請選擇日期"},null,8,["modelValue"])]),_:1}),o(f,{label:"標題"},{default:n(()=>[o(k,{modelValue:a.value.title,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.title=t),placeholder:"請輸入"},null,8,["modelValue"])]),_:1}),o(f,{label:"內容"},{default:n(()=>[o(k,{modelValue:a.value.content,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.content=t),type:"textarea",placeholder:"請輸入日記內容"},null,8,["modelValue"])]),_:1}),l("div",X,[o(C,{onClick:e[6]||(e[6]=t=>p.value=!1)},{default:n(()=>e[13]||(e[13]=[m("取消")])),_:1,__:[13]}),o(C,{type:"primary","native-type":"submit",loading:i.value},{default:n(()=>e[14]||(e[14]=[m("送出")])),_:1,__:[14]},8,["loading"])])]),_:1})]),_:1},8,["modelValue"])]),R(l("div",q,e[16]||(e[16]=[l("span",{class:"loader-icon"},null,-1),l("span",{style:{"margin-left":"8px",color:"#252c74"}},"載入中...",-1)]),512),[[$,i.value]])],64)}}},Z=E(G,[["__scopeId","data-v-70f4e7ed"]]);export{Z as default};
