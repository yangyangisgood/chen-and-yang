import{_ as A}from"./CjHayypu.js";import{_ as F,r as m,o as $,x as v,z as o,L as I,B as t,V as J,U as S,O as w,P as U,C as n,S as P,R as H,T as c,g as r,y as p,D as d,A as k,N as K,W as Q}from"./CfDvJfcy.js";const W={class:"container"},G=["disabled"],Z={class:"wood-background"},q={class:"sushi-grid"},X=["onClick"],ee=["src"],le={key:0},te={style:{"margin-top":"1em","text-align":"center"}},oe={style:{"text-align":"right"}},ae={id:"loader"},C="https://script.google.com/macros/s/AKfycbxCpBro8KBNZ_ObB8RaURjjC8oRmJ0DT08rcCzHiQelAe1Onrztax9fwLzUdb6QjWf8/exec",ne={__name:"index",setup(se){const y=m([]),_=m(!1),f=m(!1),u=m(!1),i=m(null),s=m({user:"",date:"",sushiType:"",content:""}),j=[{label:"小黃瓜捲",file:"cucumber.png",emoji:"🥒"},{label:"玉子燒壽司",file:"tamago.png",emoji:"🍳"},{label:"蝦壽司",file:"shrimp.png",emoji:"🍤"},{label:"干貝壽司",file:"scallop.png",emoji:"🦪"},{label:"鰻魚壽司",file:"eel.png",emoji:"⚡🐟"},{label:"鮪魚壽司",file:"tuna.png",emoji:"🐠"},{label:"鮭魚壽司",file:"salmon.png",emoji:"🍣"},{label:"鮭魚壽司加芥末",file:"salmon-wasabi.png",emoji:"🌶️🍣"}];function T(){s.value={user:"",date:"",sushiType:"",content:""}}function M(a){const e=j.find(V=>V.label===a);return e?`/chen-and-yang/image/${e.file}`:""}function h(){u.value=!0,T(),fetch(`${C}?action=list`).then(a=>a.json()).then(a=>y.value=a.reverse()).catch(()=>c.error("載入失敗")).finally(()=>u.value=!1)}function N(a){i.value=a,_.value=!0}function O(){if(y.value.length>=8){c.error("最多八顆壽司！請先吃掉一些！");return}f.value=!0}function Y(){const a={...s.value,id:Date.now()};u.value=!0,fetch(C,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify(a),redirect:"follow"}).then(e=>e.json()).then(e=>{if(e.success)c.success("新增成功！"),f.value=!1,h();else throw new Error}).catch(()=>c.error("新增失敗")).finally(()=>u.value=!1)}function z(){i.value&&Q.confirm("請先與伴侶討論，確定要吃掉壽司嗎？","！！！！！",{confirmButtonText:"是的，可以吃掉了",cancelButtonText:"再想一下"}).then(()=>{u.value=!0,fetch(C,{method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"},body:JSON.stringify({action:"delete",id:i.value.id}),redirect:"follow"}).then(a=>a.json()).then(a=>{if(a.success)c.success("壽司已成功吃掉（消化中）🍣💨"),_.value=!1,h();else throw new Error}).catch(()=>c.error("刪除失敗，壽司還沒咽下去...")).finally(()=>{u.value=!1})}).catch(()=>{})}return $(h),(a,e)=>{const V=A,g=r("el-button"),B=r("el-dialog"),x=r("el-option"),D=r("el-select"),b=r("el-form-item"),E=r("el-date-picker"),L=r("el-input"),R=r("el-form");return p(),v(w,null,[o("div",W,[t(V,{title:"不迴轉壽司","page-color":"sushi-doesnt-go-round"}),o("button",{class:"add-btn",onClick:O,disabled:u.value}," 捏一顆壽司 ",8,G),o("div",Z,[o("div",q,[(p(!0),v(w,null,U(y.value,l=>(p(),v("div",{class:"sushi-item",key:l.id,onClick:ue=>N(l)},[o("img",{class:"sushi-img",src:M(l.sushiType),alt:"壽司"},null,8,ee)],8,X))),128))])]),i.value?(p(),J(B,{key:0,modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),title:"詳細內容",width:"90%",class:P(i.value.sushiType==="鮭魚壽司加芥末"?"wasabi":"")},{default:n(()=>[i.value?(p(),v("div",le,[o("p",null,[e[7]||(e[7]=o("strong",null,"🗓 日期：",-1)),d(k(i.value.date),1)]),o("p",null,[e[8]||(e[8]=o("strong",null,"🧑 壽司師傅：",-1)),d(k(i.value.user),1)]),o("p",null,[e[9]||(e[9]=o("strong",null,"📓 內容：",-1)),d(k(i.value.content),1)]),o("div",te,[t(g,{type:"danger",onClick:z},{default:n(()=>e[10]||(e[10]=[d("吃掉壽司")])),_:1,__:[10]})])])):S("",!0)]),_:1},8,["modelValue","class"])):S("",!0),t(B,{modelValue:f.value,"onUpdate:modelValue":e[6]||(e[6]=l=>f.value=l),title:"捏捏捏捏捏壽司",width:"90%"},{default:n(()=>[t(R,{onSubmit:K(Y,["prevent"]),"label-width":"80px"},{default:n(()=>[t(b,{label:"壽司師傅"},{default:n(()=>[t(D,{modelValue:s.value.user,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.user=l),placeholder:"你是誰"},{default:n(()=>[t(x,{label:"洋",value:"洋"}),t(x,{label:"陳",value:"陳"})]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"日期"},{default:n(()=>[t(E,{modelValue:s.value.date,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.date=l),type:"date",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",placeholder:"請選擇日期"},null,8,["modelValue"])]),_:1}),t(b,{label:"項目"},{default:n(()=>[t(L,{modelValue:s.value.content,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.content=l),type:"textarea",placeholder:"請輸入不爽的小事"},null,8,["modelValue"])]),_:1}),t(b,{label:"壽司口味"},{default:n(()=>[t(D,{modelValue:s.value.sushiType,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.sushiType=l),placeholder:"選擇一種壽司"},{default:n(()=>[(p(),v(w,null,U(j,l=>t(x,{key:l.label,label:l.label+l.emoji,value:l.label},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),o("div",oe,[t(g,{onClick:T},{default:n(()=>e[11]||(e[11]=[d("清空")])),_:1,__:[11]}),t(g,{onClick:e[5]||(e[5]=l=>f.value=!1)},{default:n(()=>e[12]||(e[12]=[d("取消")])),_:1,__:[12]}),t(g,{type:"primary","native-type":"submit",loading:u.value},{default:n(()=>e[13]||(e[13]=[d("送出")])),_:1,__:[13]},8,["loading"])])]),_:1})]),_:1},8,["modelValue"])]),I(o("div",ae,e[14]||(e[14]=[o("span",{class:"loader-icon"},null,-1),o("span",{style:{"margin-left":"8px",color:"#252c74"}},"載入中...",-1)]),512),[[H,u.value]])],64)}}},de=F(ne,[["__scopeId","data-v-08347aa4"]]);export{de as default};
