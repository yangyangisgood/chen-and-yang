import{_ as A}from"./BVMUTMYW.js";import{N as x,_ as S,r as c,k as b,o as z,x as f,z as o,D as k,B as I,O as T,P as E,Q as _,L as F,M as j,A as u,R as D,S as m,y as g}from"./CXwq6Dzg.js";const q=x("/image/f-orange.png"),N=x("/image/f-pink.png"),R={class:"header"},U=["disabled"],P=["disabled"],J={id:"todo-list"},O=["onClick"],Q=["onClick","disabled"],G={id:"progress-bar-container"},K={id:"progress-label"},W={id:"progress-bar"},h="https://script.google.com/macros/s/AKfycbz_ls8nqd7ArsdeHJS2BotDasBAr4sP4O08LivCtdFswJPulsuswrnnQ7SrXW7hwxmi/exec",X={__name:"index",setup(Y){const i=c(""),n=c([]),l=c(!1),v=c(!1),w=b(()=>n.value.filter(t=>t.checked===!0||t.checked==="true").length),d=b(()=>n.value.length===0?0:Math.round(w.value/n.value.length*100));function C(t){return t.checked===!0||t.checked==="true"}function y(){l.value=!0,fetch(`${h}?action=list`).then(t=>t.json()).then(t=>{n.value=t}).catch(()=>alert("載入失敗")).finally(()=>l.value=!1)}function B(){if(!i.value)return;const t="temp-"+Date.now(),e={id:t,content:i.value,checked:!1};n.value.push(e),i.value="",fetch(`${h}?action=add&content=${encodeURIComponent(e.content)}`).then(a=>a.json()).then(a=>{const s=n.value.findIndex(r=>r.id===t);s!==-1&&a.id&&(n.value[s].id=a.id)}).catch(()=>{n.value=n.value.filter(a=>a.id!==t),alert("新增失敗")})}function H(t){const e=n.value[t],a=e.checked;e.checked=!a,d.value===100&&L(),fetch(`${h}?action=update&id=${e.id}&checked=${e.checked}`).then(s=>s.json()).then(s=>{if(s.status!=="success")throw new Error}).catch(()=>{e.checked=a,alert("更新失敗")})}function $(t){if(!confirm("確定刪除？"))return;const e=n.value.findIndex(s=>s.id===t),a=n.value[e];n.value.splice(e,1),fetch(`${h}?action=delete&id=${t}`).then(s=>s.json()).then(s=>{if(s.status!=="success")throw new Error}).catch(()=>{n.value.splice(e,0,a),alert("刪除失敗")})}function L(){v.value=!1,requestAnimationFrame(()=>{v.value=!0})}function M(){const t=document.getElementById("todo-list"),e=document.getElementById("progress-bar-container"),a=document.getElementById("todo-form"),r=document.querySelector("h1").offsetHeight+a.offsetHeight+32,p=e.offsetHeight+46,V=window.innerHeight-r-p;t.style.maxHeight=V+"px",t.style.overflowY="auto"}return z(()=>{y(),M()}),(t,e)=>{const a=A;return g(),f("div",{class:m(["container",{"pink-mode":d.value===100}])},[o("div",R,[o("button",{class:"back-btn",onClick:e[0]||(e[0]=s=>t.$router.push("/"))},e[2]||(e[2]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-compact-left",viewBox:"0 0 16 16"},[o("path",{"fill-rule":"evenodd",d:"M9.224 1.553a.5.5 0 0 1 .223.67L6.56 8l2.888 5.776a.5.5 0 1 1-.894.448l-3-6a.5.5 0 0 1 0-.448l3-6a.5.5 0 0 1 .67-.223"})],-1),k(" 返回 ")])),e[3]||(e[3]=o("h1",null,"待辦清單",-1)),e[4]||(e[4]=o("img",{src:q,class:"deco-items",id:"orange-flower"},null,-1)),e[5]||(e[5]=o("img",{src:N,class:"deco-items",id:"pink-flower"},null,-1))]),o("form",{id:"todo-form",autocomplete:"off",onSubmit:_(B,["prevent"])},[T(o("input",{type:"text",id:"new-todo",placeholder:"新增待辦...","onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),disabled:l.value},null,8,U),[[E,i.value,void 0,{trim:!0}]]),o("button",{class:"add-btn",type:"submit",disabled:l.value},"新增",8,P)],32),o("ul",J,[(g(!0),f(F,null,j(n.value,(s,r)=>(g(),f("li",{key:s.id,class:m({checked:C(s)}),onClick:p=>H(r)},[o("span",null,u(s.content),1),o("button",{class:"del-btn",onClick:_(p=>$(s.id),["stop"]),disabled:l.value},e[6]||(e[6]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[o("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),o("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1)]),8,Q)],10,O))),128))]),o("div",G,[o("div",K," 已完成 "+u(w.value)+" / "+u(n.value.length)+"（"+u(d.value)+"%） ",1),o("div",W,[o("div",{id:"progress-bar-fill",style:D({width:d.value+"%",backgroundColor:d.value===100?"#f39083":"#69491A"})},null,4)])]),e[8]||(e[8]=k(" <")),I(a,{visible:l.value,color:"#69491a"},null,8,["visible"]),o("div",{id:"heart-burst",class:m({animate:v.value})},e[7]||(e[7]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"heart-icon",viewBox:"0 0 16 16",fill:"#FF69B4"},[o("path",{d:"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"})],-1)]),2)],2)}}},oe=S(X,[["__scopeId","data-v-41ec124e"]]);export{oe as default};
