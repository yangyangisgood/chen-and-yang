import{K as x,_ as A,r as c,k as w,o as V,x as p,z as t,L as b,D as z,M as I,N as k,O as T,P,A as u,Q as j,R as E,S as f,y as m}from"./BNJaIras.js";const F=x("/image/f-orange.png"),D=x("/image/f-pink.png"),K=["disabled"],U=["disabled"],q={id:"todo-list"},R=["onClick"],N=["onClick","disabled"],G={id:"progress-bar-container"},J={id:"progress-label"},O={id:"progress-bar"},Q={id:"loader"},h="https://script.google.com/macros/s/AKfycbz_ls8nqd7ArsdeHJS2BotDasBAr4sP4O08LivCtdFswJPulsuswrnnQ7SrXW7hwxmi/exec",W={__name:"index",setup(X){const i=c(""),n=c([]),l=c(!1),v=c(!1),g=w(()=>n.value.filter(o=>o.checked===!0||o.checked==="true").length),d=w(()=>n.value.length===0?0:Math.round(g.value/n.value.length*100));function _(o){return o.checked===!0||o.checked==="true"}function C(){l.value=!0,fetch(`${h}?action=list`).then(o=>o.json()).then(o=>{n.value=o}).catch(()=>alert("載入失敗")).finally(()=>l.value=!1)}function y(){if(!i.value)return;const o="temp-"+Date.now(),e={id:o,content:i.value,checked:!1};n.value.push(e),i.value="",fetch(`${h}?action=add&content=${encodeURIComponent(e.content)}`).then(s=>s.json()).then(s=>{const a=n.value.findIndex(r=>r.id===o);a!==-1&&s.id&&(n.value[a].id=s.id)}).catch(()=>{n.value=n.value.filter(s=>s.id!==o),alert("新增失敗")})}function B(o){const e=n.value[o],s=e.checked;e.checked=!s,d.value===100&&M(),fetch(`${h}?action=update&id=${e.id}&checked=${e.checked}`).then(a=>a.json()).then(a=>{if(a.status!=="success")throw new Error}).catch(()=>{e.checked=s,alert("更新失敗")})}function L(o){if(!confirm("確定刪除？"))return;const e=n.value.findIndex(a=>a.id===o),s=n.value[e];n.value.splice(e,1),fetch(`${h}?action=delete&id=${o}`).then(a=>a.json()).then(a=>{if(a.status!=="success")throw new Error}).catch(()=>{n.value.splice(e,0,s),alert("刪除失敗")})}function M(){v.value=!1,requestAnimationFrame(()=>{v.value=!0})}function H(){const o=document.getElementById("todo-list"),e=document.getElementById("progress-bar-container"),s=document.getElementById("todo-form"),r=document.querySelector("h1").offsetHeight+s.offsetHeight+32,$=e.offsetHeight+46,S=window.innerHeight-r-$;o.style.maxHeight=S+"px",o.style.overflowY="auto"}return V(()=>{C(),H()}),(o,e)=>(m(),p("div",{class:f(["container",{"pink-mode":d.value===100}])},[t("button",{class:"back-btn",onClick:e[0]||(e[0]=s=>o.$router.push("/"))},e[2]||(e[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-chevron-compact-left",viewBox:"0 0 16 16"},[t("path",{"fill-rule":"evenodd",d:"M9.224 1.553a.5.5 0 0 1 .223.67L6.56 8l2.888 5.776a.5.5 0 1 1-.894.448l-3-6a.5.5 0 0 1 0-.448l3-6a.5.5 0 0 1 .67-.223"})],-1),z(" 返回 ")])),e[6]||(e[6]=t("h1",null,[t("a",{href:"https://docs.google.com/spreadsheets/d/1MMnLWBfr-XKPe99Pm5mKrlj0aI1wpG2LPC8hPKLog2U/edit?usp=sharing",target:"_blank"}," 待辦清單 ")],-1)),t("form",{id:"todo-form",autocomplete:"off",onSubmit:k(y,["prevent"])},[b(t("input",{type:"text",id:"new-todo",placeholder:"新增待辦...","onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),disabled:l.value},null,8,K),[[I,i.value,void 0,{trim:!0}]]),t("button",{class:"add-btn",type:"submit",disabled:l.value},"新增",8,U)],32),t("ul",q,[(m(!0),p(T,null,P(n.value,(s,a)=>(m(),p("li",{key:s.id,class:f({checked:_(s)}),onClick:r=>B(a)},[t("span",null,u(s.content),1),t("button",{class:"del-btn",onClick:k(r=>L(s.id),["stop"]),disabled:l.value},e[3]||(e[3]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"currentColor",class:"bi bi-trash",viewBox:"0 0 16 16"},[t("path",{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"}),t("path",{d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"})],-1)]),8,N)],10,R))),128))]),t("div",G,[t("div",J," 已完成 "+u(g.value)+" / "+u(n.value.length)+"（"+u(d.value)+"%） ",1),t("div",O,[t("div",{id:"progress-bar-fill",style:j({width:d.value+"%",backgroundColor:d.value===100?"#f39083":"#69491A"})},null,4)])]),e[7]||(e[7]=t("div",{class:"deco-container"},[t("img",{src:F,class:"deco-items",id:"orange-flower"}),t("img",{src:D,class:"deco-items",id:"pink-flower"})],-1)),b(t("div",Q,e[4]||(e[4]=[t("span",{class:"loader-icon"},null,-1),t("span",{style:{"margin-left":"8px"}},"載入中...",-1)]),512),[[E,l.value]]),t("div",{id:"heart-burst",class:f({animate:v.value})},e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"heart-icon",viewBox:"0 0 16 16",fill:"#FF69B4"},[t("path",{d:"m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"})],-1)]),2)],2))}},ee=A(W,[["__scopeId","data-v-ad81e915"]]);export{ee as default};
